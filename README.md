[![Build Status](https://travis-ci.org/praekelt/swagger-django-generator.svg?branch=master)](https://travis-ci.org/praekelt/swagger-django-generator)

# swagger-django-generator
Convert Swagger specifications into Django code

<!-- START doctoc generated TOC please keep comment here to allow auto update -->
<!-- DON'T EDIT THIS SECTION, INSTEAD RE-RUN doctoc TO UPDATE -->
**Table of Contents**  *generated with [DocToc](https://github.com/thlorenz/doctoc)*

- [Introduction](#introduction)
- [Getting started](#getting-started)
- [Examples](#examples)
  - [A demo application](#a-demo-application)
  - [Examples of the files that are generated](#examples-of-the-files-that-are-generated)
    - [`urls.py`](#urlspy)
    - [`schemas.py`](#schemaspy)
    - [`views.py`](#viewspy)
- [Todo](#todo)

<!-- END doctoc generated TOC please keep comment here to allow auto update -->

## Introduction
This utility parses a Swagger specification and generates Django-specific
definitions, which allows for easy integration into Django projects.
In particular, the following files are currently generated:
* `urls.py`, for routing requests,
* `views.py`, for handling requests, performing validation, etc., and
* `schemas.py`, containing the JSONSchema definitions of parameters and
  request body arguments.
* `utils.py`, containing utility functions that can be tweaked, if necessary.

## Getting started
A virtual environment can be set up by running
```
make virtualenv
./ve/bin/python manage.py develop  # Installs package so that templates can be found
```
This utility is self-documenting. To get an idea of what is supported, simply
run the utility with the `--help` flag:
```
└─▪ ./ve/bin/python swagger_django_generator/generator.py --help
Usage: generator.py [OPTIONS] SPECIFICATION

Options:
  --verbose / --no-verbose
  --output-dir DIRECTORY
  --module-name TEXT         The name of the module where the generated code
                             will be used, e.g. myproject.some_application
  --urls-file TEXT           Use an alternative filename for the urls.
  --views-file TEXT          Use an alternative filename for the views.
  --schemas-file TEXT        Use an alternative filename for the schemas.
  --utils-file TEXT          Use an alternative filename for the utilities.
  --stubs / --no-stubs       Generate a stub file as well.
  --stubs-file TEXT          Use an alternative filename for the utilities.
  --help                     Show this message and exit.
```

At the time of writing the ulity expects you to implement your logic in a `stubs.py` file.
The name of this file will be made configurable in future releases.
Both `yaml` and `json` specifications are supported.

## Examples

### A demo application
For a quick demonstration of how to get started, run `make demo`. This will create a demo Django application that uses files generated by this application. The command does the following in the back:
```bash
# Create a new Django project
./ve/bin/django-admin startproject demo
# Generate files for the petstore API (including stubs) straight into the project
./ve/bin/python swagger_django_generator/generator.py tests/resources/petstore.json --output-dir demo/demo/ --module-name demo --stubs
```
You can then start the server:
```
./ve/bin/python demo/manage.py runserver
```

## Notes
* All generated API calls are CSRF exempt
* API calls that have any form of security defined on them will require a logged in user or basic HTTP auth.
* At this stage there are **limited tests**.

## Todo
* Mocking using `apitools`!
* Currently the generated code expects logic to be implemented in a file called `stubs.py`. This needs to be made configurable.
* We can look at using the `swagger-tester` library.
* Investigate using [warlock](https://github.com/bcwaldon/warlock) or [python-jsonschema-objects](https://github.com/cwacek/python-jsonschema-objects) to generate models for ease of use.
